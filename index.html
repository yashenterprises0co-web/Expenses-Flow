<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expenses Flow | Financial Management Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --primary-light: #eef2ff;
            --secondary: #6c757d;
            --success: #28a745;
            --success-light: #e6ffed;
            --danger: #dc3545;
            --danger-light: #ffebee;
            --warning: #ffc107;
            --info: #17a2b8;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border: #dee2e6;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --sidebar-width: 260px;
            --header-height: 70px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        #app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            box-shadow: var(--card-shadow);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            transition: var(--transition);
            transform: translateX(-100%);
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            height: var(--header-height);
            display: flex;
            align-items: center;
            background: var(--primary);
        }

        .sidebar-header h2 {
            color: white;
            font-size: 1.5rem;
            margin: 0;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
            cursor: pointer;
        }

        .menu-item:hover {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .menu-item.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }

        .menu-item i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 0;
            transition: var(--transition);
        }

        .main-content.expanded {
            margin-left: var(--sidebar-width);
        }

        /* Header */
        .header {
            height: var(--header-height);
            background: white;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 99;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark);
            margin-right: 15px;
        }

        .page-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .user-name {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .action-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .action-btn:hover {
            background: var(--primary-dark);
        }

        /* Content Area */
        .content {
            padding: 25px;
        }

        /* Dashboard */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.invoices {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .stat-icon.quotations {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }

        .stat-icon.challans {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }

        .stat-info h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .dashboard-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .action-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .action-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .action-card h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        .action-card p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
        }

        .form-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .form-header h2 {
            font-size: 1.5rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .form-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #bd2130;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--dark);
        }

        .btn-outline:hover {
            background: var(--light);
        }

        /* Tables */
        .data-table-container {
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .table-header h2 {
            font-size: 1.3rem;
            color: var(--dark);
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--light);
            text-align: left;
            padding: 15px 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .data-table td {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            color: var(--dark);
        }

        .data-table tr:hover {
            background-color: rgba(67, 97, 238, 0.03);
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-paid {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }

        .table-action-btn {
            background: none;
            border: none;
            color: var(--secondary);
            cursor: pointer;
            padding: 5px;
            font-size: 1rem;
            transition: var(--transition);
            margin: 0 3px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .table-action-btn:hover {
            background: var(--light);
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
        }

        .btn-whatsapp:hover {
            background: #128C7E;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 500px;
            overflow: hidden;
        }

        .modal-header {
            padding: 20px;
            background: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.3rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            padding: 15px 20px;
            background: var(--light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* WhatsApp Sharing Form */
        .whatsapp-form .form-group {
            margin-bottom: 20px;
        }

        .whatsapp-form label {
            font-weight: 500;
            margin-bottom: 8px;
            display: block;
        }

        /* Login View */
        .login-container {
            display: flex;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 40px;
            text-align: center;
        }

        .login-logo {
            margin-bottom: 30px;
        }

        .login-logo h1 {
            color: var(--primary);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .login-logo p {
            color: var(--gray);
            font-size: 1.1rem;
        }

        .login-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }

        .google-signin {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: white;
            border: 1px solid var(--border);
            padding: 12px 20px;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .google-signin:hover {
            background: var(--light);
        }

        /* Admin Panel */
        .admin-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .divider {
            height: 1px;
            background: var(--border);
            margin: 20px 0;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-admin {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .badge-user {
            background: rgba(108, 117, 125, 0.1);
            color: var(--secondary);
        }

        .mt-2 {
            margin-top: 10px;
        }

        .mt-3 {
            margin-top: 15px;
        }

        .mt-4 {
            margin-top: 20px;
        }

        .document-preview {
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 8px;
            background: white;
            margin-top: 20px;
        }

        .document-header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .document-title {
            font-size: 1.8rem;
            color: var(--primary);
        }

        .document-meta {
            text-align: right;
        }

        .document-body {
            margin-bottom: 30px;
        }

        .document-footer {
            margin-top: 30px;
            border-top: 1px solid var(--border);
            padding-top: 20px;
            text-align: right;
        }

        .total-amount {
            font-size: 1.4rem;
            font-weight: bold;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content.expanded {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 15px;
            }
            .content {
                padding: 15px;
            }
            .user-name {
                display: none;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
            .dashboard-actions {
                grid-template-columns: 1fr;
            }
            .table-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div id="login-view" class="login-container">
        <div class="login-card">
            <div class="login-logo">
                <h1>Expenses Flow</h1>
                <p>Manage invoices, quotations & challans efficiently</p>
            </div>
            <div class="login-options">
                <button id="google-signin-btn" class="google-signin">
                    <i class="fab fa-google"></i>
                    Sign in with Google
                </button>
            </div>
            <div class="divider"></div>
            <p class="text-muted">Secured by Google Identity Services</p>
        </div>
    </div>

    <div id="app-container" class="hidden">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Expenses Flow</h2>
            </div>
            <div class="sidebar-menu">
                <a class="menu-item active" data-view="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a class="menu-item" data-view="create-invoice">
                    <i class="fas fa-file-invoice"></i> Create Invoice
                </a>
                <a class="menu-item" data-view="create-quotation">
                    <i class="fas fa-file-contract"></i> Create Quotation
                </a>
                <a class="menu-item" data-view="create-challan">
                    <i class="fas fa-truck-loading"></i> Create Challan
                </a>
                <a class="menu-item" data-view="view-documents">
                    <i class="fas fa-folder-open"></i> View Documents
                </a>
                <a class="menu-item" data-view="admin-panel">
                    <i class="fas fa-user-cog"></i> Admin Panel
                </a>
                <a class="menu-item" data-view="settings">
                    <i class="fas fa-cog"></i> Settings
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <button class="menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Dashboard</h1>
                </div>
                <div class="header-right">
                    <button class="action-btn" id="new-document-btn">
                        <i class="fas fa-plus"></i> New Document
                    </button>
                    <div class="user-profile" id="user-profile">
                        <img id="user-avatar" src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" class="user-avatar">
                        <span class="user-name" id="user-name">John Smith</span>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content">
                <!-- Dashboard View -->
                <div id="dashboard-view" class="view-content">
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon invoices">
                                <i class="fas fa-file-invoice"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="invoice-count">24</h3>
                                <p>Invoices</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon quotations">
                                <i class="fas fa-file-contract"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="quotation-count">18</h3>
                                <p>Quotations</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon challans">
                                <i class="fas fa-truck-loading"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="challan-count">32</h3>
                                <p>Challans</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-actions">
                        <div class="action-card" data-action="create-invoice">
                            <div class="action-icon">
                                <i class="fas fa-file-invoice"></i>
                            </div>
                            <h3>Create Invoice</h3>
                            <p>Generate professional invoices for your clients</p>
                            <button class="btn btn-outline">Create Now</button>
                        </div>
                        <div class="action-card" data-action="create-quotation">
                            <div class="action-icon">
                                <i class="fas fa-file-contract"></i>
                            </div>
                            <h3>Create Quotation</h3>
                            <p>Send price estimates to potential customers</p>
                            <button class="btn btn-outline">Create Now</button>
                        </div>
                        <div class="action-card" data-action="create-challan">
                            <div class="action-icon">
                                <i class="fas fa-truck-loading"></i>
                            </div>
                            <h3>Create Challan</h3>
                            <p>Generate delivery challans for goods shipment</p>
                            <button class="btn btn-outline">Create Now</button>
                        </div>
                        <div class="action-card" data-action="view-documents">
                            <div class="action-icon">
                                <i class="fas fa-folder-open"></i>
                            </div>
                            <h3>View Documents</h3>
                            <p>Access all your invoices, quotations & challans</p>
                            <button class="btn btn-outline">View Now</button>
                        </div>
                    </div>

                    <div class="form-container">
                        <div class="form-header">
                            <h2>Recent Documents</h2>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Document #</th>
                                        <th>Date</th>
                                        <th>Client</th>
                                        <th>Type</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-documents-body">
                                    <!-- Documents will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Create Invoice View -->
                <div id="create-invoice-view" class="view-content hidden">
                    <div class="form-container">
                        <div class="form-header">
                            <h2><i class="fas fa-file-invoice me-2"></i>Create New Invoice</h2>
                        </div>
                        <form id="invoice-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="invoice-number">Invoice Number</label>
                                    <input type="text" id="invoice-number" class="form-control" value="INV-2023-001" readonly>
                                </div>
                                <div class="form-group">
                                    <label for="invoice-date">Date</label>
                                    <input type="date" id="invoice-date" class="form-control" value="">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="client-name">Client Name</label>
                                    <input type="text" id="client-name" class="form-control" placeholder="Enter client name">
                                </div>
                                <div class="form-group">
                                    <label for="client-contact">Contact Number</label>
                                    <input type="tel" id="client-contact" class="form-control" placeholder="Enter contact number">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="invoice-description">Description</label>
                                <textarea id="invoice-description" class="form-control" rows="3" placeholder="Enter description of services or products"></textarea>
                            </div>
                            
                            <h3 class="mt-4 mb-3">Items</h3>
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Item Description</th>
                                            <th>Quantity</th>
                                            <th>Price per Item</th>
                                            <th>Tax (%)</th>
                                            <th>Discount (%)</th>
                                            <th>Total</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="invoice-items">
                                        <tr>
                                            <td><input type="text" class="form-control item-desc" placeholder="Item description"></td>
                                            <td><input type="number" class="form-control item-qty" value="1" min="1"></td>
                                            <td><input type="number" class="form-control item-price" value="100.00" step="0.01"></td>
                                            <td><input type="number" class="form-control item-tax" value="10" min="0" max="100"></td>
                                            <td><input type="number" class="form-control item-discount" value="0" min="0" max="100"></td>
                                            <td class="item-total">$110.00</td>
                                            <td><button type="button" class="btn btn-danger btn-sm delete-item"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" class="btn btn-outline mt-3" id="add-item-btn"><i class="fas fa-plus"></i> Add Item</button>
                            </div>
                            
                            <div class="form-row mt-4">
                                <div class="form-group">
                                    <label for="due-date">Due Date</label>
                                    <input type="date" id="due-date" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="notes">Notes</label>
                                    <textarea id="notes" class="form-control" rows="2" placeholder="Any additional notes"></textarea>
                                </div>
                            </div>
                            
                            <div class="form-footer">
                                <button type="button" class="btn btn-outline" id="cancel-invoice">Cancel</button>
                                <button type="submit" class="btn btn-primary">Create Invoice</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- View Documents View -->
                <div id="view-documents-view" class="view-content hidden">
                    <div class="data-table-container">
                        <div class="table-header">
                            <h2>All Documents</h2>
                            <div class="table-actions">
                                <button class="btn btn-outline" id="print-all-btn"><i class="fas fa-print"></i> Print All</button>
                                <button class="btn btn-primary" id="export-btn"><i class="fas fa-download"></i> Export</button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Document #</th>
                                        <th>Date</th>
                                        <th>Client</th>
                                        <th>Type</th>
                                        <th>Amount</th>
                                        <th>Due Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="all-documents-body">
                                    <!-- Documents will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Document Preview View -->
                <div id="document-preview-view" class="view-content hidden">
                    <div class="form-container">
                        <div class="form-header">
                            <h2 id="preview-doc-title">Document Preview</h2>
                            <div class="table-actions">
                                <button class="btn btn-outline" id="print-preview-btn"><i class="fas fa-print"></i> Print</button>
                                <button class="btn btn-primary" id="download-preview-btn"><i class="fas fa-download"></i> Download</button>
                            </div>
                        </div>
                        <div class="document-preview" id="document-preview-content">
                            <!-- Document content will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Admin Panel View -->
                <div id="admin-panel-view" class="view-content hidden">
                    <div class="admin-panel">
                        <div class="form-container">
                            <div class="form-header">
                                <h2><i class="fas fa-user-plus me-2"></i>Add New User</h2>
                            </div>
                            <form id="add-user-form">
                                <div class="form-group">
                                    <label for="new-user-name">Full Name</label>
                                    <input type="text" id="new-user-name" class="form-control" placeholder="Enter full name">
                                </div>
                                <div class="form-group">
                                    <label for="new-user-email">Email Address</label>
                                    <input type="email" id="new-user-email" class="form-control" placeholder="Enter email address">
                                </div>
                                <div class="form-group">
                                    <label for="user-role">Role</label>
                                    <select id="user-role" class="form-control">
                                        <option value="user">Standard User</option>
                                        <option value="admin">Administrator</option>
                                    </select>
                                </div>
                                <div class="form-footer">
                                    <button type="reset" class="btn btn-outline">Reset</button>
                                    <button type="submit" class="btn btn-primary">Add User</button>
                                </div>
                            </form>
                        </div>

                        <div class="form-container">
                            <div class="form-header">
                                <h2><i class="fas fa-users me-2"></i>User Management</h2>
                            </div>
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Role</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="users-body">
                                        <!-- Users will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="form-container mt-4">
                        <div class="table-header">
                            <h2>System Logs</h2>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>User</th>
                                        <th>Action</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="logs-body">
                                    <!-- Logs will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Settings View -->
                <div id="settings-view" class="view-content hidden">
                    <div class="form-container">
                        <div class="form-header">
                            <h2><i class="fas fa-user-circle me-2"></i>User Profile</h2>
                        </div>
                        <div class="form-row">
                            <div class="text-center">
                                <img id="profile-avatar" src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" class="user-avatar" style="width: 100px; height: 100px;">
                                <button class="btn btn-outline mt-2" id="change-photo-btn">Change Photo</button>
                            </div>
                            <div>
                                <div class="form-group">
                                    <label for="profile-name">Full Name</label>
                                    <input type="text" id="profile-name" class="form-control" value="John Smith">
                                </div>
                                <div class="form-group">
                                    <label for="profile-email">Email</label>
                                    <input type="email" id="profile-email" class="form-control" value="john@example.com" readonly>
                                </div>
                                <div class="form-group">
                                    <label for="profile-phone">Contact Number</label>
                                    <input type="tel" id="profile-phone" class="form-control" value="+1 (555) 123-4567">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-container mt-4">
                        <div class="form-header">
                            <h2><i class="fas fa-cog me-2"></i>Application Settings</h2>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="language">Language</label>
                                <select id="language" class="form-control">
                                    <option value="en">English</option>
                                    <option value="es">Marathi</option>
                                    <option value="fr">Hindi</option>
                                    <option value="de">Bengali</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="currency">Currency</label>
                                <select id="currency" class="form-control">
                                    <option value="usd">US Dollar (USD)</option>
                                    <option value="eur">Indian Rupees (INR)</option>
                                    <option value="gbp">British Pound (GBP)</option>
                                    <option value="jpy">Japanese Yen (JPY)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="theme">Theme</label>
                            <select id="theme" class="form-control">
                                <option value="light">Light Theme</option>
                                <option value="dark">Dark Theme</option>
                                <option value="blue">Blue Theme</option>
                            </select>
                        </div>
                        <div class="form-footer">
                            <button class="btn btn-outline" id="reset-settings-btn">Reset Settings</button>
                            <button class="btn btn-primary" id="save-settings-btn">Save Changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Deletion</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this document? This action cannot be undone.</p>
                <p><strong>Document ID:</strong> <span id="delete-doc-id">INV-2023-001</span></p>
                <p><strong>Client:</strong> <span id="delete-doc-client">Global Tech Solutions</span></p>
                <div class="mt-3">
                    <label>
                        <input type="checkbox" id="confirm-delete">
                        I confirm that I want to permanently delete this document
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline cancel-delete">Cancel</button>
                <button class="btn btn-danger confirm-delete" disabled>Delete Document</button>
            </div>
        </div>
    </div>

    <!-- WhatsApp Sharing Modal -->
    <div id="whatsapp-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Share Document via WhatsApp</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form class="whatsapp-form">
                    <div class="form-group">
                        <label for="document-id">Document</label>
                        <input type="text" id="document-id" class="form-control" value="INV-2023-001" readonly>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="client-number">Client WhatsApp Number</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                <input type="tel" id="client-number" class="form-control" placeholder="Client WhatsApp number" value="+1 (555) 123-4567">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="md-number">Company MD's WhatsApp</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user-tie"></i></span>
                                <input type="tel" id="md-number" class="form-control" value="+1 (555) 987-6543" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="whatsapp-message">Message</label>
                        <textarea id="whatsapp-message" class="form-control" rows="4" placeholder="Add a custom message...">Dear Client,

Please find attached the document for your reference.

Regards,
Expenses Flow Team</textarea>
                    </div>
                    
                    <div class="mt-3">
                        <label>
                            <input type="checkbox" id="attach-pdf" checked>
                            Attach PDF version of document
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline cancel-whatsapp">Cancel</button>
                <button class="btn btn-success send-whatsapp">
                    <i class="fab fa-whatsapp"></i> Send via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const state = {
            currentUser: null,
            documents: [],
            users: [],
            logs: [],
            settings: {
                language: 'en',
                currency: 'usd',
                theme: 'light'
            },
            nextDocId: 1
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const loginView = document.getElementById('login-view');
            const appContainer = document.getElementById('app-container');
            const menuToggle = document.querySelector('.menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('.main-content');
            const menuItems = document.querySelectorAll('.menu-item');
            const viewContents = document.querySelectorAll('.view-content');
            const actionCards = document.querySelectorAll('.action-card');
            const googleSignInBtn = document.getElementById('google-signin-btn');
            const deleteModal = document.getElementById('delete-modal');
            const whatsappModal = document.getElementById('whatsapp-modal');
            const modalCloses = document.querySelectorAll('.modal-close');
            const cancelDeletes = document.querySelectorAll('.cancel-delete');
            const cancelWhatsapp = document.querySelector('.cancel-whatsapp');
            const confirmDeleteBtn = document.querySelector('.confirm-delete');
            const sendWhatsappBtn = document.querySelector('.send-whatsapp');
            const confirmDeleteCheck = document.getElementById('confirm-delete');
            const newDocumentBtn = document.getElementById('new-document-btn');
            const addItemBtn = document.getElementById('add-item-btn');
            const invoiceForm = document.getElementById('invoice-form');
            const cancelInvoiceBtn = document.getElementById('cancel-invoice');
            const printAllBtn = document.getElementById('print-all-btn');
            const exportBtn = document.getElementById('export-btn');
            const addUserForm = document.getElementById('add-user-form');
            const saveSettingsBtn = document.getElementById('save-settings-btn');
            const resetSettingsBtn = document.getElementById('reset-settings-btn');
            
            // Initialize demo data
            initializeDemoData();
            
            // Initialize Google Sign-in
            function initGoogleSignIn() {
                googleSignInBtn.addEventListener('click', function() {
                    // Simulate Google sign-in
                    handleLoginSuccess({
                        name: "John Smith",
                        email: "john@example.com",
                        avatar: "https://randomuser.me/api/portraits/men/32.jpg",
                        role: "admin",
                        isAdmin: true
                    });
                });
            }
            
            // Handle successful login
            function handleLoginSuccess(userData) {
                // Hide login view, show app
                loginView.classList.add('hidden');
                appContainer.classList.remove('hidden');
                
                // Set user info
                state.currentUser = userData;
                document.getElementById('user-name').textContent = userData.name;
                document.getElementById('user-avatar').src = userData.avatar;
                document.getElementById('profile-name').value = userData.name;
                document.getElementById('profile-contact number').value = userData.email;
                document.getElementById('profile-avatar').src = userData.avatar;
                
                // Update UI
                updateDocumentCounts();
                renderRecentDocuments();
                renderAllDocuments();
                renderUsers();
                renderLogs();
                
                // Add log entry
                addLog(`${userData.name} logged in`);
            }
            
            // Toggle sidebar on mobile
            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                mainContent.classList.toggle('expanded');
            });
            
            // Navigation
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update active menu item
                    menuItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Get target view
                    const targetView = this.getAttribute('data-view');
                    
                    // Hide all views
                    viewContents.forEach(view => view.classList.add('hidden'));
                    
                    // Show target view
                    document.getElementById(`${targetView}-view`).classList.remove('hidden');
                    
                    // Update page title
                    document.querySelector('.page-title').textContent = this.textContent.trim();
                    
                    // Close sidebar on mobile after selection
                    if (window.innerWidth < 992) {
                        sidebar.classList.remove('active');
                        mainContent.classList.remove('expanded');
                    }
                    
                    // If viewing documents, refresh the list
                    if (targetView === 'view-documents') {
                        renderAllDocuments();
                    }
                });
            });
            
            // Action card navigation
            actionCards.forEach(card => {
                card.addEventListener('click', function() {
                    const action = this.getAttribute('data-action');
                    
                    // Update menu
                    menuItems.forEach(i => i.classList.remove('active'));
                    document.querySelector(`.menu-item[data-view="${action}"]`).classList.add('active');
                    
                    // Show target view
                    viewContents.forEach(view => view.classList.add('hidden'));
                    document.getElementById(`${action}-view`).classList.remove('hidden');
                    
                    // Update page title
                    document.querySelector('.page-title').textContent = this.querySelector('h3').textContent;
                });
            });
            
            // New Document button
            newDocumentBtn.addEventListener('click', function() {
                // Update menu
                menuItems.forEach(i => i.classList.remove('active'));
                document.querySelector(`.menu-item[data-view="create-invoice"]`).classList.add('active');
                
                // Show target view
                viewContents.forEach(view => view.classList.add('hidden'));
                document.getElementById('create-invoice-view').classList.remove('hidden');
                
                // Update page title
                document.querySelector('.page-title').textContent = "Create Invoice";
            });
            
            // Add item to invoice
            addItemBtn.addEventListener('click', function() {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td><input type="text" class="form-control item-desc" placeholder="Item description"></td>
                    <td><input type="number" class="form-control item-qty" value="1" min="1"></td>
                    <td><input type="number" class="form-control item-price" value="100.00" step="0.01"></td>
                    <td><input type="number" class="form-control item-tax" value="10" min="0" max="100"></td>
                    <td><input type="number" class="form-control item-discount" value="0" min="0" max="100"></td>
                    <td class="item-total">$110.00</td>
                    <td><button type="button" class="btn btn-danger btn-sm delete-item"><i class="fas fa-trash"></i></button></td>
                `;
                document.getElementById('invoice-items').appendChild(newRow);
                
                // Add event listeners to new inputs
                const inputs = newRow.querySelectorAll('input');
                inputs.forEach(input => {
                    input.addEventListener('input', calculateItemTotal);
                });
                
                // Add event listener to delete button
                newRow.querySelector('.delete-item').addEventListener('click', function() {
                    newRow.remove();
                });
            });
            
            // Calculate item total
            function calculateItemTotal() {
                const row = this.closest('tr');
                const qty = parseFloat(row.querySelector('.item-qty').value) || 0;
                const price = parseFloat(row.querySelector('.item-price').value) || 0;
                const tax = parseFloat(row.querySelector('.item-tax').value) || 0;
                const discount = parseFloat(row.querySelector('.item-discount').value) || 0;
                
                // Calculate total
                let total = qty * price;
                total = total * (1 - discount/100); // Apply discount
                total = total * (1 + tax/100); // Apply tax
                
                row.querySelector('.item-total').textContent = '$' + total.toFixed(2);
            }
            
            // Add event listeners to existing inputs
            document.querySelectorAll('.item-qty, .item-price, .item-tax, .item-discount').forEach(input => {
                input.addEventListener('input', calculateItemTotal);
            });
            
            // Delete item
            document.addEventListener('click', function(e) {
                if (e.target.closest('.delete-item')) {
                    e.target.closest('tr').remove();
                }
            });
            
            // Submit invoice form
            invoiceForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Create document
                const doc = {
                    id: `INV-${new Date().getFullYear()}-${state.nextDocId.toString().padStart(3, '0')}`,
                    type: 'Invoice',
                    date: document.getElementById('invoice-date').value || new Date().toISOString().split('T')[0],
                    client: document.getElementById('client-name').value || 'Unnamed Client',
                    contact: document.getElementById('client-contact').value || '',
                    description: document.getElementById('invoice-description').value || '',
                    dueDate: document.getElementById('due-date').value || '',
                    notes: document.getElementById('notes').value || '',
                    items: [],
                    total: 0,
                    status: 'Pending',
                    createdAt: new Date().toISOString(),
                    createdBy: state.currentUser.email
                };
                
                // Calculate items and total
                let total = 0;
                document.querySelectorAll('#invoice-items tr').forEach(row => {
                    const desc = row.querySelector('.item-desc').value || 'Item';
                    const qty = parseFloat(row.querySelector('.item-qty').value) || 0;
                    const price = parseFloat(row.querySelector('.item-price').value) || 0;
                    const tax = parseFloat(row.querySelector('.item-tax').value) || 0;
                    const discount = parseFloat(row.querySelector('.item-discount').value) || 0;
                    
                    // Calculate item total
                    let itemTotal = qty * price;
                    itemTotal = itemTotal * (1 - discount/100);
                    itemTotal = itemTotal * (1 + tax/100);
                    
                    doc.items.push({
                        description: desc,
                        quantity: qty,
                        price: price,
                        tax: tax,
                        discount: discount,
                        total: itemTotal
                    });
                    
                    total += itemTotal;
                });
                
                doc.total = total;
                
                // Add document to state
                state.documents.unshift(doc);
                state.nextDocId++;
                
                // Add log entry
                addLog(`${state.currentUser.name} created invoice ${doc.id}`);
                
                // Update UI
                updateDocumentCounts();
                renderRecentDocuments();
                renderAllDocuments();
                
                // Show success message
                alert(`Invoice ${doc.id} created successfully!`);
                
                // Reset form
                invoiceForm.reset();
                document.getElementById('invoice-items').innerHTML = `
                    <tr>
                        <td><input type="text" class="form-control item-desc" placeholder="Item description"></td>
                        <td><input type="number" class="form-control item-qty" value="1" min="1"></td>
                        <td><input type="number" class="form-control item-price" value="100.00" step="0.01"></td>
                        <td><input type="number" class="form-control item-tax" value="10" min="0" max="100"></td>
                        <td><input type="number" class="form-control item-discount" value="0" min="0" max="100"></td>
                        <td class="item-total">$110.00</td>
                        <td><button type="button" class="btn btn-danger btn-sm delete-item"><i class="fas fa-trash"></i></button></td>
                    </tr>
                `;
                
                // Navigate to documents view
                menuItems.forEach(i => i.classList.remove('active'));
                document.querySelector(`.menu-item[data-view="view-documents"]`).classList.add('active');
                viewContents.forEach(view => view.classList.add('hidden'));
                document.getElementById('view-documents-view').classList.remove('hidden');
                document.querySelector('.page-title').textContent = "View Documents";
            });
            
            // Cancel invoice
            cancelInvoiceBtn.addEventListener('click', function() {
                invoiceForm.reset();
                
                // Navigate to dashboard
                menuItems.forEach(i => i.classList.remove('active'));
                document.querySelector(`.menu-item[data-view="dashboard"]`).classList.add('active');
                viewContents.forEach(view => view.classList.add('hidden'));
                document.getElementById('dashboard-view').classList.remove('hidden');
                document.querySelector('.page-title').textContent = "Dashboard";
            });
            
            // Print all documents
            printAllBtn.addEventListener('click', function() {
                alert('All documents sent to printer!');
                addLog(`${state.currentUser.name} printed all documents`);
            });
            
            // Export documents
            exportBtn.addEventListener('click', function() {
                alert('Documents exported successfully!');
                addLog(`${state.currentUser.name} exported documents`);
            });
            
            // Add user
            addUserForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('new-user-name').value;
                const number = document.getElementById('new-user-contact number').value;
                const role = document.getElementById('user-role').value;
                
                if (!name || !contact number) {
                    alert('Please fill in all fields');
                    return;
                }
                
                // Add user
                state.users.push({
                    id: state.users.length + 1,
                    name: name,
                    contact number: contact number,
                    role: role,
                    status: 'Active'
                });
                
                // Add log entry
                addLog(`${state.currentUser.name} added user ${name}`);
                
                // Update UI
                renderUsers();
                
                // Show success message
                alert(`User ${name} added successfully!`);
                
                // Reset form
                addUserForm.reset();
            });
            
            // Save settings
            saveSettingsBtn.addEventListener('click', function() {
                state.settings.language = document.getElementById('language').value;
                state.settings.currency = document.getElementById('currency').value;
                state.settings.theme = document.getElementById('theme').value;
                
                // Apply theme
                if (state.settings.theme === 'dark') {
                    document.body.style.backgroundColor = '#333';
                    document.body.style.color = '#fff';
                } else {
                    document.body.style.backgroundColor = '#f5f7fb';
                    document.body.style.color = '#333';
                }
                
                // Add log entry
                addLog(`${state.currentUser.name} updated settings`);
                
                // Show success message
                alert('Settings saved successfully!');
            });
            
            // Reset settings
            resetSettingsBtn.addEventListener('click', function() {
                document.getElementById('language').value = 'en';
                document.getElementById('currency').value = 'inr';
                document.getElementById('theme').value = 'light';
                document.getElementById('profile-name').value = state.currentUser.name;
                document.getElementById('profile-phone').value = '+1 (555) 123-4567';
                
                // Reset theme
                document.body.style.backgroundColor = '#f5f7fb';
                document.body.style.color = '#333';
                
                alert('Settings reset to default values!');
            });
            
            // Initialize demo data
            function initializeDemoData() {
                // Create demo users
                state.users = [
                    { id: 1, name: "John Smith", email: "john@example.com", role: "admin", status: "Active" },

                ];
                
                // Create demo documents
                state.documents = [
                    {
                        id: "INV-2025-001",
                        type: "Invoice",
                        date: "2025-08-15",
                        client: "Global Tech Solutions",
                        contact: "+1 (555) 123-4567",
                        description: "Web development services",
                        dueDate: "2025-08-15",
                        notes: "Payment due within 15 days",
                        items: [
                            { description: "Website Design", quantity: 1, price: 1500, tax: 10, discount: 0, total: 1650 },
                            { description: "API Development", quantity: 1, price: 800, tax: 10, discount: 0, total: 880 }
                        ],
                        total: 2530,
                        status: "Paid",
                        createdAt: "2023-06-15T10:30:00Z",
                        createdBy: "john@example.com"
                    },
                    {
                        id: "QUO-2025-01",
                        type: "Quotation",
                        date: "2025-08-15",
                        client: "Innovate Services Ltd",
                        contact: "+1 (555) 987-6543",
                        description: "Mobile app development proposal",
                        dueDate: "",
                        notes: "Valid for 30 days",
                        items: [
                            { description: "App Design", quantity: 1, price: 2000, tax: 10, discount: 10, total: 1980 },
                            { description: "Backend Development", quantity: 1, price: 1500, tax: 10, discount: 0, total: 1650 }
                        ],
                        total: 3630,
                        status: "Pending",
                        createdAt: "2025-08-18T09:15:00Z",
                        createdBy: "sarah@example.com"
                    },
                    {
                        id: "CHL-2025-01",
                        type: "Challan",
                        date: "2025-08-15",
                        client: "Prime Logistics",
                        contact: "+1 (555) 456-7890",
                        description: "Hardware delivery",
                        dueDate: "",
                        notes: "All items delivered in good condition",
                        items: [
                            { description: "Server Rack", quantity: 2, price: 800, tax: 0, discount: 0, total: 1600 },
                            { description: "Network Switches", quantity: 5, price: 200, tax: 0, discount: 5, total: 950 }
                        ],
                        total: 2550,
                        status: "Delivered",
                        createdAt: "2025-08-20T14:20:00Z",
                        createdBy: "michael@example.com"
                    }
                ];
                
                state.nextDocId = 4;
                
                // Create demo logs
                state.logs = [
                    { timestamp: "2023-06-25 10:30:15", user: "John Smith", action: "Created Invoice", details: "INV-2023-025" },
                ];
            }
            
            // Update document counts
            function updateDocumentCounts() {
                const invoices = state.documents.filter(doc => doc.type === 'Invoice').length;
                const quotations = state.documents.filter(doc => doc.type === 'Quotation').length;
                const challans = state.documents.filter(doc => doc.type === 'Challan').length;
                
                document.getElementById('invoice-count').textContent = invoices;
                document.getElementById('quotation-count').textContent = quotations;
                document.getElementById('challan-count').textContent = challans;
            }
            
            // Render recent documents
            function renderRecentDocuments() {
                const tbody = document.getElementById('recent-documents-body');
                tbody.innerHTML = '';
                
                // Get 3 most recent documents
                const recentDocs = [...state.documents].sort((a, b) => 
                    new Date(b.createdAt) - new Date(a.createdAt)
                ).slice(0, 3);
                
                recentDocs.forEach(doc => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${doc.id}</td>
                        <td>${doc.date}</td>
                        <td>${doc.client}</td>
                        <td>${doc.type}</td>
                        <td>$${doc.total.toFixed(2)}</td>
                        <td><span class="status-badge ${doc.status === 'Paid' || doc.status === 'Delivered' ? 'status-paid' : 'status-pending'}">${doc.status}</span></td>
                        <td>
                            <button class="table-action-btn view-doc" data-id="${doc.id}" title="View"><i class="fas fa-eye"></i></button>
                            <button class="table-action-btn print-doc" data-id="${doc.id}" title="Print"><i class="fas fa-print"></i></button>
                            <button class="table-action-btn download-doc" data-id="${doc.id}" title="Download"><i class="fas fa-download"></i></button>
                            <button class="table-action-btn btn-whatsapp share-doc" data-id="${doc.id}" title="Share via WhatsApp"><i class="fab fa-whatsapp"></i></button>
                            <button class="table-action-btn delete-doc" data-id="${doc.id}" title="Delete"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Add event listeners
                addDocumentActionListeners();
            }
            
            // Render all documents
            function renderAllDocuments() {
                const tbody = document.getElementById('all-documents-body');
                tbody.innerHTML = '';
                
                state.documents.forEach(doc => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${doc.id}</td>
                        <td>${doc.date}</td>
                        <td>${doc.client}</td>
                        <td>${doc.type}</td>
                        <td>$${doc.total.toFixed(2)}</td>
                        <td>${doc.dueDate || '-'}</td>
                        <td><span class="status-badge ${doc.status === 'Paid' || doc.status === 'Delivered' ? 'status-paid' : 'status-pending'}">${doc.status}</span></td>
                        <td>
                            <button class="table-action-btn view-doc" data-id="${doc.id}" title="View"><i class="fas fa-eye"></i></button>
                            <button class="table-action-btn edit-doc" data-id="${doc.id}" title="Edit"><i class="fas fa-edit"></i></button>
                            <button class="table-action-btn print-doc" data-id="${doc.id}" title="Print"><i class="fas fa-print"></i></button>
                            <button class="table-action-btn download-doc" data-id="${doc.id}" title="Download"><i class="fas fa-download"></i></button>
                            <button class="table-action-btn btn-whatsapp share-doc" data-id="${doc.id}" title="Share via WhatsApp"><i class="fab fa-whatsapp"></i></button>
                            <button class="table-action-btn delete-doc" data-id="${doc.id}" title="Delete"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Add event listeners
                addDocumentActionListeners();
            }
            
            // Add document action listeners
            function addDocumentActionListeners() {
                // View document
                document.querySelectorAll('.view-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        const doc = state.documents.find(d => d.id === docId);
                        
                        if (doc) {
                            renderDocumentPreview(doc);
                            
                            // Update menu
                            menuItems.forEach(i => i.classList.remove('active'));
                            
                            // Show preview view
                            viewContents.forEach(view => view.classList.add('hidden'));
                            document.getElementById('document-preview-view').classList.remove('hidden');
                            document.querySelector('.page-title').textContent = "Document Preview";
                        }
                    });
                });
                
                // Edit document
                document.querySelectorAll('.edit-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        const doc = state.documents.find(d => d.id === docId);
                        
                        if (doc) {
                            // Check if edit is allowed (within 24 hours or admin)
                            const docDate = new Date(doc.createdAt);
                            const now = new Date();
                            const diffHours = Math.abs(now - docDate) / 36e5;
                            
                            if (diffHours <= 24 || state.currentUser.isAdmin) {
                                alert(`Editing document ${docId}...`);
                                // In a real app, we would open the edit form here
                            } else {
                                alert('You can only edit documents created within the last 24 hours');
                            }
                        }
                    });
                });
                
                // Print document
                document.querySelectorAll('.print-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        alert(`Printing document ${docId}...`);
                        addLog(`${state.currentUser.name} printed document ${docId}`);
                    });
                });
                
                // Download document
                document.querySelectorAll('.download-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        alert(`Downloading document ${docId}...`);
                        addLog(`${state.currentUser.name} downloaded document ${docId}`);
                    });
                });
                
                // Share document via WhatsApp
                document.querySelectorAll('.share-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        const doc = state.documents.find(d => d.id === docId);
                        
                        if (doc) {
                            document.getElementById('document-id').value = doc.id;
                            document.getElementById('client-number').value = doc.contact;
                            whatsappModal.classList.add('active');
                        }
                    });
                });
                
                // Delete document
                document.querySelectorAll('.delete-doc').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.getAttribute('data-id');
                        const doc = state.documents.find(d => d.id === docId);
                        
                        if (doc) {
                            document.getElementById('delete-doc-id').textContent = doc.id;
                            document.getElementById('delete-doc-client').textContent = doc.client;
                            deleteModal.classList.add('active');
                        }
                    });
                });
            }
            
            // Render document preview
            function renderDocumentPreview(doc) {
                document.getElementById('preview-doc-title').textContent = `${doc.type} Preview`;
                
                let itemsHtml = '';
                doc.items.forEach(item => {
                    itemsHtml += `
                        <tr>
                            <td>${item.description}</td>
                            <td>${item.quantity}</td>
                            <td>$${item.price.toFixed(2)}</td>
                            <td>${item.tax}%</td>
                            <td>${item.discount}%</td>
                            <td>$${item.total.toFixed(2)}</td>
                        </tr>
                    `;
                });
                
                const previewHtml = `
                    <div class="document-header">
                        <div>
                            <h1 class="document-title">${doc.type}</h1>
                            <p>${doc.id}</p>
                        </div>
                        <div class="document-meta">
                            <p><strong>Date:</strong> ${doc.date}</p>
                            <p><strong>Due Date:</strong> ${doc.dueDate || 'N/A'}</p>
                        </div>
                    </div>
                    
                    <div class="document-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label>From</label>
                                <p>Expenses Flow Inc<br>123 Business Street<br>New York, NY 10001</p>
                            </div>
                            <div class="form-group">
                                <label>To</label>
                                <p>${doc.client}<br>${doc.contact || 'Contact not provided'}</p>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label>Description</label>
                            <p>${doc.description}</p>
                        </div>
                        
                        <div class="mt-4">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Description</th>
                                        <th>Quantity</th>
                                        <th>Unit Price</th>
                                        <th>Tax</th>
                                        <th>Discount</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${itemsHtml}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="document-footer">
                        <div class="total-amount">Total: $${doc.total.toFixed(2)}</div>
                        <div class="mt-2">
                            <p><strong>Notes:</strong> ${doc.notes || 'No additional notes'}</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('document-preview-content').innerHTML = previewHtml;
                
                // Add event listeners to preview buttons
                document.getElementById('print-preview-btn').addEventListener('click', function() {
                    alert(`Printing document ${doc.id}...`);
                    addLog(`${state.currentUser.name} printed document ${doc.id}`);
                });
                
                document.getElementById('download-preview-btn').addEventListener('click', function() {
                    alert(`Downloading document ${doc.id}...`);
                    addLog(`${state.currentUser.name} downloaded document ${doc.id}`);
                });
            }
            
            // Render users
            function renderUsers() {
                const tbody = document.getElementById('users-body');
                tbody.innerHTML = '';
                
                state.users.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td><span class="badge ${user.role === 'admin' ? 'badge-admin' : 'badge-user'}">${user.role}</span></td>
                        <td>${user.status}</td>
                        <td>
                            <button class="table-action-btn edit-user" data-id="${user.id}" title="Edit"><i class="fas fa-edit"></i></button>
                            <button class="table-action-btn text-danger delete-user" data-id="${user.id}" title="Delete"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
                
                // Add user action listeners
                document.querySelectorAll('.edit-user').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const userId = this.getAttribute('data-id');
                        const user = state.users.find(u => u.id == userId);
                        
                        if (user) {
                            alert(`Editing user ${user.name}...`);
                        }
                    });
                });
                
                document.querySelectorAll('.delete-user').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const userId = this.getAttribute('data-id');
                        const user = state.users.find(u => u.id == userId);
                        
                        if (user) {
                            if (confirm(`Are you sure you want to delete user ${user.name}?`)) {
                                state.users = state.users.filter(u => u.id != userId);
                                renderUsers();
                                addLog(`${state.currentUser.name} deleted user ${user.name}`);
                                alert(`User ${user.name} deleted successfully!`);
                            }
                        }
                    });
                });
            }
            
            // Render logs
            function renderLogs() {
                const tbody = document.getElementById('logs-body');
                tbody.innerHTML = '';
                
                state.logs.forEach(log => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${log.timestamp}</td>
                        <td>${log.user}</td>
                        <td>${log.action}</td>
                        <td>${log.details}</td>
                    `;
                    tbody.appendChild(row);
                });
            }
            
            // Add log entry
            function addLog(action) {
                const now = new Date();
                const timestamp = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
                
                state.logs.unshift({
                    timestamp: timestamp,
                    user: state.currentUser.name,
                    action: action,
                    details: ''
                });
                
                // Keep only the last 50 logs
                if (state.logs.length > 50) {
                    state.logs.pop();
                }
                
                renderLogs();
            }
            
            // Modal close functionality
            modalCloses.forEach(btn => {
                btn.addEventListener('click', function() {
                    deleteModal.classList.remove('active');
                    whatsappModal.classList.remove('active');
                });
            });
            
            cancelDeletes.forEach(btn => {
                btn.addEventListener('click', function() {
                    deleteModal.classList.remove('active');
                });
            });
            
            cancelWhatsapp.addEventListener('click', function() {
                whatsappModal.classList.remove('active');
            });
            
            // Confirm delete checkbox
            confirmDeleteCheck.addEventListener('change', function() {
                confirmDeleteBtn.disabled = !this.checked;
            });
            
            // Delete document
            confirmDeleteBtn.addEventListener('click', function() {
                const docId = document.getElementById('delete-doc-id').textContent;
                
                // Remove document from state
                const docIndex = state.documents.findIndex(d => d.id === docId);
                if (docIndex !== -1) {
                    const doc = state.documents[docIndex];
                    state.documents.splice(docIndex, 1);
                    
                    // Add log entry
                    addLog(`${state.currentUser.name} deleted document ${docId}`);
                    
                    // Update UI
                    updateDocumentCounts();
                    renderRecentDocuments();
                    renderAllDocuments();
                    
                    alert(`Document ${docId} has been deleted successfully.`);
                }
                
                deleteModal.classList.remove('active');
            });
            
            // Send WhatsApp message
            sendWhatsappBtn.addEventListener('click', function() {
                const docId = document.getElementById('document-id').value;
                const clientNumber = document.getElementById('client-number').value;
                const mdNumber = document.getElementById('md-number').value;
                const message = document.getElementById('whatsapp-message').value;
                
                // Add log entry
                addLog(`${state.currentUser.name} shared document ${docId} via WhatsApp`);
                
                // Show success message
                alert(`Document ${docId} has been sent to:\nClient: ${clientNumber}\nCompany MD: ${mdNumber}\n\nMessage: ${message}`);
                
                whatsappModal.classList.remove('active');
            });
            
            // Set current date for new invoices
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoice-date').value = today;
            document.getElementById('due-date').value = today;
            
            // Initialize the app
            initGoogleSignIn();
        });
    </script>
</body>
</html>
